# ==========================================
# CONFIGURAÇÃO
# ==========================================

CC      = riscv64-linux-gnu-gcc
CFLAGS  = -march=rv64gc -mabi=lp64d -static -g
TARGET  = pilha

SRCS    = main.s pilha.s
OBJS    = main.o pilha.o


# ==========================================
# REGRA PADRÃO
# ==========================================

all: $(TARGET)


# ==========================================
# LINKAGEM
# ==========================================

$(TARGET): $(OBJS)
	$(CC) $(CFLAGS) $(OBJS) -o $(TARGET)


# ==========================================
# COMPILAÇÃO INDIVIDUAL
# ==========================================

%.o: %.s
	$(CC) $(CFLAGS) -c $< -o $@


# ==========================================
# EXECUÇÃO NO QEMU
# ==========================================

run: $(TARGET)
	qemu-riscv64 ./$(TARGET)


# ==========================================
# DEBUG REMOTO
# ==========================================

debug: $(TARGET)
	qemu-riscv64 -g 1234 ./$(TARGET)


# ==========================================
# LIMPEZA
# ==========================================

clean:
	rm -f $(OBJS) $(TARGET)


# ==========================================
# RECOMPILAR DO ZERO
# ==========================================

rebuild: clean all
